#!/usr/bin/env ruby
require 'curses'
require File.expand_path('../../lib/rfd', __FILE__)

Curses.cbreak
Curses.noecho
Curses.init_screen
Curses.start_color

begin
  rfd = Rfd::BaseWindow.new ARGV[0] || '.'

  loop do
    c = Curses.getch
    case c
    when 10  # enter
      rfd.enter
    when 27  # esc
      rfd.q
    when 127  # BS
      rfd.bs
    when (?a)..(?z), (?A)..(?Z)
      rfd.main.public_send c if rfd.command_mode? && rfd.main.respond_to?(c)
    else
      p c
    end
  end
ensure
  Curses.close_screen
end
